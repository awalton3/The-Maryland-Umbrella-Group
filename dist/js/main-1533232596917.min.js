(function(angular){
'use strict';
angular
    .module('root', [
    'common',
    'components',
    'templates'
  ]);
})(window.angular);
(function(angular){
'use strict';
angular
  .module('common', [
    'ui.router',
    'ngMaterial',
    'ngMessages',
  ]);
})(window.angular);
(function(angular){
'use strict';
angular
    .module('components', [
    'components.auth',
    'components.memos'
  ])
})(window.angular);
(function(angular){
'use strict';
/**
 *
 * @ngdoc object
 * @name components.auth
 *
 * @requires ui.router,ngParse,ngMaterial,ngMessages
 *
 * @description
 *
 * This is the auth module. It includes login, register, and reset components for auth feature.
 *
 **/

angular
    .module('components.auth', [
    'ui.router',
    'ngParse',
    'ngMaterial',
    'ngMessages'
  ])
    .config(["ParseProvider", function (ParseProvider) {
        var MY_PARSE_APP_ID = 'uDzN7E7NYIbwdzKLUwNBtDtGfxyxrrBo3C6xGri3';
        var MY_PARSE_JS_KEY = '0VcWEWBLIwEcExM2Nz3TziSGjKiMsoU7SNjI5RPA';
        ParseProvider.initialize(MY_PARSE_APP_ID, MY_PARSE_JS_KEY);
        ParseProvider.serverURL = 'https://parseapi.back4app.com/';

    }])
    .run(["$transitions", "$state", "AuthService", function ($transitions, $state, AuthService) {
        $transitions.onStart({
            to: function (state) {
                return !!(state.data && state.data.requiredAuth);
            }
        }, function () {
            return AuthService
                .requireAuthentication()
                .catch(function () {
                    return $state.target('auth');
                });
        });
        $transitions.onStart({
            to: 'auth'
        }, function () {
            if (AuthService.isAuthenticated()) {
                return $state.go('app');
            }
        });
    }]);
})(window.angular);
(function(angular){
'use strict';
angular
    .module('components.memos', [
    'ui.router'
  ]);
})(window.angular);
(function(angular){
'use strict';
var root = {
    templateUrl: './root.html'
};

angular
    .module('root')
    .component('root', root);
})(window.angular);
(function(angular){
'use strict';
var app = {
    templateUrl: './app.html',
    controller: 'AppController'
};

angular
    .module('common')
    .component('app', app)
    .config(["$stateProvider", function ($stateProvider) {
        $stateProvider
            .state('app', {
                redirectTo: 'memos',
                url: '/',
                data: {
                    requiredAuth: true
                },
                component: 'app'
            })
    }]);
})(window.angular);
(function(angular){
'use strict';
AppController.$inject = ["AuthService", "$state"];
function AppController(AuthService, $state) {
    var ctrl = this;
    ctrl.user = AuthService.getUser();
    ctrl.logout = function () {
        AuthService.logout()
            .then(function () {
                $state.go('auth.login');
            });
    };
}

angular
    .module('common')
    .controller('AppController', AppController);
})(window.angular);
(function(angular){
'use strict';
init.$inject = ["$rootScope", "$uiRouter", "$mdSidenav"];
function init($rootScope, $uiRouter, $mdSidenav) {
    var Visualizer = window['ui-router-visualizer'].Visualizer;
    var pluginInstance = $uiRouter.plugin(Visualizer);

    $rootScope.toggleMenu = toggleMenu;

    function toggleMenu(navId) {
        console.log('toggle sidenav: ' + navId);
        $mdSidenav(navId)
            .toggle();
    }
}

angular
    .module('common')
    .run(init)
})(window.angular);
(function(angular){
'use strict';
var auth = {
    templateUrl: './auth.html',
    controller: 'AuthController'
};

angular
    .module('components.auth')
    .component('auth', auth)
    .config(["$stateProvider", "$urlRouterProvider", function ($stateProvider, $urlRouterProvider) {
        $stateProvider
            // .state('auth', {
            //     redirectTo: 'auth',
            //     url: '/auth',
            //     templateUrl: './auth.html'
            // })
            .state('auth', {
                url: '/auth',
                component: 'auth'
            });
         $urlRouterProvider.otherwise('/auth');
    }]);
})(window.angular);
(function(angular){
'use strict';
/**
 * @ngdoc service
 * @name components.auth:AuthService
 *
 * @description Handles authentication for app
 */

AuthService.$inject = ["Parse"];
function AuthService(Parse) {
    var auth = new Parse.User(); // creates a new user in Parse
    var currentUser = null; //holds info about current user

    /**
     * @ngdoc method
     * @name AuthService#storeAuthData
     * @methodOf components.auth:AuthService
     * @param {object} obj Parse user object
     * @returns {object} returns currentUser object
     */

    function storeAuthData(response) {
        currentUser = response;
        return currentUser;
    }

    /**
     * @ngdoc method
     * @name AuthService#clearAuthData
     * @methodOf components.auth:AuthService
     * @returns {object} returns a blank user object
     */

    function clearAuthData() {
        currentUser = Parse.User.current(); // this will now be null
        return currentUser;
    }

    /**
     * @ngdoc method
     * @name AuthService#login
     * @methodOf components.auth:AuthService
     * @param {object} obj user data from auth-form
     * @returns {object} returns the current user object
     */

    this.login = function (user) {
        return Parse.User
            .logIn(user.email, user.password, {
                success: function (auth) {},
                error: function (auth, error) {
                    console.log(error);
                }
            })
            .then(storeAuthData)
            .then((currentUser) => {
                sessionStorage.setItem('currentUser', currentUser)
            });

    };

    /**
     * @ngdoc method
     * @name AuthService#register
     * @methodOf components.auth:AuthService
     * @param {object} obj user data from auth-form
     * @returns {object} returns the current user object
     */

    this.register = function (user) {
        //console.log("User: ", user);
        auth.set("username", user.email);
        auth.set("password", user.password);
        auth.set("email", user.email);
        return auth
            .signUp(null, {
                success: function (auth) {},
                error: function (auth, error) {
                    alert("Error: " + error.code + " " + error.message);
                }
            })
            .then(storeAuthData);
    };

    /**
     * @ngdoc method
     * @name AuthService#logout
     * @methodOf components.auth:AuthService
     * @returns {object} returns an empty user object
     */

    this.logout = function () {
        return Parse.User.logOut()
            .then(clearAuthData);
    };

    /**
     * @ngdoc method
     * @name AuthService#requireAuthentication
     * @methodOf components.auth:AuthService
     * @returns {promise} returns resolve or reject based on user authentication
     */

    this.requireAuthentication = function () {
        return new Promise(function (resolve, reject) {
            if (!!Parse.User.current() && Parse.User.current()
                .authenticated()) {
                resolve();
            } else {
                reject();
            }
        });
    }

    /**
     * @ngdoc method
     * @name AuthService#isAuthenticated
     * @methodOf components.auth:AuthService
     * @returns {boolean} returns whether user is authenticated based on sessionStorage
     */

    this.isAuthenticated = function () {
        // return !!(Parse.User.current() && Parse.User.current()
        //     .authenticated());
    };

    /**
     * @ngdoc method
     * @name AuthService#getUser
     * @methodOf components.auth:AuthService
     * @returns {object} returns currentUser sessionStorage object
     */

    this.getUser = function () {
        if (auth) {
            return auth;
        }
    };
};

angular
    .module('components.auth')
    .service('AuthService', AuthService);
})(window.angular);
(function(angular){
'use strict';
var memos = {
    templateUrl: './memos.html',
    controller: 'MemosController',
    bindings: {}
}

angular
    .module('components.memos')
    .component('memos', memos)
    .config(["$stateProvider", function ($stateProvider) {
        $stateProvider.state('memos', {
            parent: 'app',
            url: 'memos',
            component: 'memos'
        })
    }]);
})(window.angular);
(function(angular){
'use strict';
MemosController.$inject = ["$state"];
function MemosController($state) {

    var ctrl = this;
    ctrl.$onInit = function () {

    }

}


angular
    .module('components.memos')
    .controller('MemosController', MemosController);
})(window.angular);
(function(angular){
'use strict';
/**
 * @ngdoc component
 * @name component.auth:authForm
 *
 * @description
 * This is the stateless component for auth form
 *
 * @example
 * login.htm
 <pre>
 <auth-form user="$ctrl.user" button="Login" on-submit="$ctrl.loginUser($event);" on-reset="$ctrl.goToReset();">
 </auth-form>
  </pre>
 *
 */

var authForm = {
    bindings: {
        user: '<',
        button: '@',
        message: '@',
        onSubmit: '&',
        onReset: '&'
    },
    templateUrl: './auth-form.html',
    controller: 'AuthFormController'
};

angular
    .module('components.auth')
    .component('authForm', authForm);
})(window.angular);
(function(angular){
'use strict';
AuthFormController.$inject = ["$state"];
function AuthFormController($state) {
  var ctrl = this;

  ctrl.$onChanges = function (changes) {
    if (changes.user) {
      ctrl.user = angular.copy(ctrl.user);
    }
  };

  ctrl.submitForm = function () {
    //console.log("submit called");
    ctrl.onSubmit({
      $event: {
        user: ctrl.user
      }
    });
  };
}

angular
    .module('components.auth')
    .controller('AuthFormController', AuthFormController);
})(window.angular);
(function(angular){
'use strict';
/**
 * @ngdoc component
 * @name component.auth:login
 *
 * @description
 * This component stores info from auth-form and handles login using AuthService
 *
 */

var login = {
    templateUrl: './login.html',
    controller: 'LoginController'
};

angular
    .module('components.auth')
    .component('login', login)
    .config(["$stateProvider", "$urlRouterProvider", function ($stateProvider, $urlRouterProvider) {
        $stateProvider
            // .state('auth', {
            //     redirectTo: 'auth.login',
            //     url: '/auth',
            //     template: '<div ui-view></div>'
            // })
            .state('auth.login', {
                url: '/login',
                component: 'login'
            });
        // $urlRouterProvider.otherwise('/auth/login');
    }]);
})(window.angular);
(function(angular){
'use strict';
LoginController.$inject = ["AuthService", "$state"];
function LoginController(AuthService, $state) {
    var ctrl = this;

    //initialize user data
    ctrl.$onInit = function () {
        ctrl.user = {
            email: '',
            password: ''
        };
    };

  //give user access to app
  ctrl.loginUser = function (event) {
    return AuthService
      .login(event.user)
      .then(function () {
        $state.go('app');
      }, function (reason) {
        alert(reason);
      });
  };

  ctrl.goToReset = function () {
    $state.go('auth.reset');
  }

}

angular
    .module('components.auth')
    .controller('LoginController', LoginController);
})(window.angular);
(function(angular){
'use strict';
/**
 * @ngdoc component
 * @name component.auth:register
 *
 * @description
 * This component stores info from auth-form and handles registering using AuthService
 *
 */

var register = {
    templateUrl: './register.html',
    controller: 'RegisterController'
};

angular
    .module('components.auth')
    .component('register', register)
    .config(["$stateProvider", function ($stateProvider) {
        $stateProvider.state('auth.register', {
            url: '/register',
            component: 'register'
        });
    }]);
})(window.angular);
(function(angular){
'use strict';
RegisterController.$inject = ["AuthService", "$state"];
function RegisterController(AuthService, $state) {
    var ctrl = this;

    //initialize user data
    ctrl.$onInit = function () {
        ctrl.error = null;
        ctrl.user = {
            email: '',
            password: ''
        };
    };

    //creates a new user and allows access into the app
    ctrl.createUser = function (event) {
        //console.log("user:", event);
        return AuthService
            .register(event.user)
            .then(function () {
                $state.go('app');
            }, function (reason) {
                ctrl.error = reason.message;
            });
    };

}

angular
    .module('components.auth')
    .controller('RegisterController', RegisterController);
})(window.angular);
(function(angular){
'use strict';
/**
 * @ngdoc component
 * @name component.auth:reset
 *
 * @description
 * This component handles password reset and is toggled in login component 
 *
 */

var reset = {
    templateUrl: './reset.html',
    controller: 'ResetController'
};

angular
    .module('components.auth')
    .component('reset', reset)
    .config(["$stateProvider", function ($stateProvider) {
        $stateProvider.state('auth.reset', {
            url: '/reset',
            component: 'reset'
        });
    }]);
})(window.angular);
(function(angular){
'use strict';
function ResetController() {

    var ctrl = this;

    ctrl.$onInit = function () {
      console.log("RESET CONTROLLER FIRED")
        // initialize variables
        ctrl.user = {};
        // initialize functions
        ctrl.reset = reset;
    }

    // password reset
    function reset(email) {
        if (email) {
            Parse
                .User
                .requestPasswordReset(email)
                .then(function () {
                    alert('A password reset email has been sent to ' + email);
                })
                .catch(function (err) {
                    alert(err.code + " " + err.message);
                });
        }
    }

}

angular
    .module('components.auth')
    .controller('ResetController', ResetController);
})(window.angular);
(function(angular){
'use strict';
angular.module('templates', []).run(['$templateCache', function($templateCache) {$templateCache.put('./root.html','<div class="root">\n    <div ui-view></div>\n</div>\n');
$templateCache.put('./app.html','<div class="root">\n    <!-- <app-nav user="$ctrl.user" on-logout="$ctrl.logout();"></app-nav> -->\n    <!-- <md-sidenav flex-order="2" md-component-id="side" md-whiteframe="3" md-disable-backdrop class="md-sidenav-right md-no-pagination app__sidenav--height app__sidenav--width app__sidenav--position app__sidenav--overflow-x">\n        <div ui-view="side"></div>\n    </md-sidenav> -->\n    <div>\n        <div ui-view></div>\n    </div>\n</div>\n');
$templateCache.put('./auth.html','<div>\n  Hello World\n</div>\n');
$templateCache.put('./memos.html','<div>\n  This is the app.\n</div>\n');
$templateCache.put('./auth-form.html','<form width="100%" name="authForm" novalidate ng-submit="$ctrl.submitForm();">\n  <div width="100%" layout="column" layout-align="center center">\n    <div>\n      <img src="img/mughub_logo.png" width="210px" />\n    </div>\n    <div style="min-width:25%">\n\n      <md-list>\n        <md-list-item class="auth__listItem--marginTop">\n          <md-input-container class="md-block" layout-fill>\n            <label style="color:  #eaeaea; font-size: 13px; font-family: \'Montserrat\', sans-serif; padding: 5px 0px 0px 20px"><i style="vertical-align: middle; color:#eaeaea; margin:0px 4px 1px 4px" class="material-icons md-18">person</i>USERNAME</label>\n            <input class="auth__input--style auth__input--height" type="email" name="email" ng-model="$ctrl.user.email" autocomplete="off" />\n          </md-input-container>\n        </md-list-item>\n        <md-list-item layout-align="center center" layout="row" class="auth__listItem--marginTop">\n          <md-input-container md-no-float class="md-block auth__input" style="position: relative; width:100%">\n            <label style="color:  #eaeaea; font-size: 13px; font-family: \'Montserrat\', sans-serif; padding: 5px 0px 0px 20px"><i style="vertical-align: middle; color:#eaeaea; margin:0px 4px" class="material-icons md-18">lock</i> PASSWORD</label>\n            <input class="auth__input--style auth__input--height" type="password" name="password" ng-model="$ctrl.user.password" autocomplete="off" />\n          </md-input-container>\n          <p ng-if="$ctrl.button === \'Login\'" ng-click="$ctrl.onReset($event)" class="auth__forgot">?</p>\n        </md-list-item>\n      </md-list>\n\n    </div>\n    <div style="margin-top: -18px;">\n      <md-button type="submit" ng-disabled="authForm.$invalid" class="md-raised auth__button auth__input--height">\n        <h1 class="auth__buttonText">{{ $ctrl.button }}</h1>\n      </md-button>\n    </div>\n  </div>\n</form>\n');
$templateCache.put('./login.html','<div class="auth" layout="column" layout-align="center">\n    <div>\n        <auth-form user="$ctrl.user" button="Login" on-submit="$ctrl.loginUser($event);" on-reset="$ctrl.goToReset();">\n        </auth-form>\n    </div>\n    <center>\n        <div>\n            <a ui-sref="auth.register" class="auth__trans">\n      Don\'t have an account? Create one here.\n    </a>\n        </div>\n    </center>\n</div>\n');
$templateCache.put('./register.html','<div class="auth" layout="column" layout-align="center">\n    <div>\n        <auth-form user="$ctrl.user" message="{{ $ctrl.error }}" button="Create user" on-submit="$ctrl.createUser($event);">\n        </auth-form>\n    </div>\n    <center>\n        <div>\n            <a ui-sref="auth.login" class="auth__trans">Already have an account? Login here.</a>\n        </div>\n    </center>\n</div>\n');
$templateCache.put('./reset.html','<div class="auth" layout="column" layout-align="center">\n    <form width="100%" name="authForm" novalidate ng-submit="$ctrl.reset($ctrl.user.email)">\n        <div width="100%" layout="column" layout-align="center center">\n            <div>\n                <img src="img/2000px-General_Electric_logo.svg.png" width="50px" />\n            </div>\n            <div style="min-width:25%">\n                <md-list>\n                    <md-list-item>\n                        <md-input-container class="md-block" layout-fill>\n                            <label>Email</label>\n                            <input type="email" name="email" ng-model="$ctrl.user.email" autocomplete="off" />\n                        </md-input-container>\n                    </md-list-item>\n                </md-list>\n            </div>\n            <div>\n                <md-button type="submit" ng-disabled="authForm.$invalid" class="md-raised auth__button">\n                    <h1 class="auth__buttonText">RESET</h1>\n                </md-button>\n            </div>\n        </div>\n    </form>\n    <center>\n        <div>\n            <a ui-sref="auth.login" class="auth__trans">Or login with an existing account.</a>\n        </div>\n    </center>\n</div>\n');}]);})(window.angular);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvb3QubW9kdWxlLmpzIiwiY29tbW9uL2FwcC5tb2R1bGUuanMiLCJjb21wb25lbnRzL2NvbXBvbmVudHMubW9kdWxlLmpzIiwiY29tcG9uZW50cy9hdXRoL2F1dGgubW9kdWxlLmpzIiwiY29tcG9uZW50cy9tZW1vcy9tZW1vcy5tb2R1bGUuanMiLCJyb290LmNvbXBvbmVudC5qcyIsImNvbW1vbi9hcHAuY29tcG9uZW50LmpzIiwiY29tbW9uL2FwcC5jb250cm9sbGVyLmpzIiwiY29tbW9uL2FwcC5ydW4uanMiLCJjb21wb25lbnRzL2F1dGgvYXV0aC5jb21wb25lbnQuanMiLCJjb21wb25lbnRzL2F1dGgvYXV0aC5zZXJ2aWNlLmpzIiwiY29tcG9uZW50cy9tZW1vcy9tZW1vcy5jb21wb25lbnQuanMiLCJjb21wb25lbnRzL21lbW9zL21lbW9zLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2F1dGgvYXV0aC1mb3JtL2F1dGgtZm9ybS5jb21wb25lbnQuanMiLCJjb21wb25lbnRzL2F1dGgvYXV0aC1mb3JtL2F1dGgtZm9ybS5jb250cm9sbGVyLmpzIiwiY29tcG9uZW50cy9hdXRoL2xvZ2luL2xvZ2luLmNvbXBvbmVudC5qcyIsImNvbXBvbmVudHMvYXV0aC9sb2dpbi9sb2dpbi5jb250cm9sbGVyLmpzIiwiY29tcG9uZW50cy9hdXRoL3JlZ2lzdGVyL3JlZ2lzdGVyLmNvbXBvbmVudC5qcyIsImNvbXBvbmVudHMvYXV0aC9yZWdpc3Rlci9yZWdpc3Rlci5jb250cm9sbGVyLmpzIiwiY29tcG9uZW50cy9hdXRoL3Jlc2V0L3Jlc2V0LmNvbXBvbmVudC5qcyIsImNvbXBvbmVudHMvYXV0aC9yZXNldC9yZXNldC5jb250cm9sbGVyLmpzIiwidGVtcGxhdGVzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLENBQUEsU0FBQSxRQUFBO0FBQ0E7QUFDQTtLQUNBLE9BQUEsUUFBQTtJQUNBO0lBQ0E7SUFDQTs7R0FFQSxPQUFBO0FDUkEsQ0FB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QUEsUUFBQTs7OztJQUlBLFNBQUEsTUFBQSxPQUFBO1FBQ0EsSUFBQSxPQUFBO1lBQ0E7aUJBQ0E7aUJBQ0EscUJBQUE7aUJBQ0EsS0FBQSxZQUFBO29CQUNBLE1BQUEsNkNBQUE7O2lCQUVBLE1BQUEsVUFBQSxLQUFBO29CQUNBLE1BQUEsSUFBQSxPQUFBLE1BQUEsSUFBQTs7Ozs7OztBQU9BO0tBQ0EsT0FBQTtLQUNBLFdBQUEsbUJBQUE7R0FDQSxPQUFBO0FDbENBLENBQUEsU0FBQSxRQUFBO0FBQ0E7QUFDQSxRQUFBLE9BQUEsYUFBQSxJQUFBLElBQUEsQ0FBQSxrQkFBQSxTQUFBLGdCQUFBLENBQUEsZUFBQSxJQUFBLGNBQUE7QUFDQSxlQUFBLElBQUEsYUFBQTtBQUNBLGVBQUEsSUFBQSxjQUFBO0FBQ0EsZUFBQSxJQUFBLGVBQUE7QUFDQSxlQUFBLElBQUEsbUJBQUE7QUFDQSxlQUFBLElBQUEsZUFBQTtBQUNBLGVBQUEsSUFBQSxrQkFBQTtBQUNBLGVBQUEsSUFBQSxlQUFBLDh1Q0FBQSxPQUFBLFNBQUEiLCJmaWxlIjoibWFpbi0xNTMzMjMyNTk2OTE3Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXJcbiAgICAubW9kdWxlKCdyb290JywgW1xuICAgICdjb21tb24nLFxuICAgICdjb21wb25lbnRzJyxcbiAgICAndGVtcGxhdGVzJ1xuICBdKTtcbiIsImFuZ3VsYXJcbiAgLm1vZHVsZSgnY29tbW9uJywgW1xuICAgICd1aS5yb3V0ZXInLFxuICAgICduZ01hdGVyaWFsJyxcbiAgICAnbmdNZXNzYWdlcycsXG4gIF0pO1xuIiwiYW5ndWxhclxuICAgIC5tb2R1bGUoJ2NvbXBvbmVudHMnLCBbXG4gICAgJ2NvbXBvbmVudHMuYXV0aCcsXG4gICAgJ2NvbXBvbmVudHMubWVtb3MnXG4gIF0pXG4iLCIvKipcbiAqXG4gKiBAbmdkb2Mgb2JqZWN0XG4gKiBAbmFtZSBjb21wb25lbnRzLmF1dGhcbiAqXG4gKiBAcmVxdWlyZXMgdWkucm91dGVyLG5nUGFyc2UsbmdNYXRlcmlhbCxuZ01lc3NhZ2VzXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogVGhpcyBpcyB0aGUgYXV0aCBtb2R1bGUuIEl0IGluY2x1ZGVzIGxvZ2luLCByZWdpc3RlciwgYW5kIHJlc2V0IGNvbXBvbmVudHMgZm9yIGF1dGggZmVhdHVyZS5cbiAqXG4gKiovXG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzLmF1dGgnLCBbXG4gICAgJ3VpLnJvdXRlcicsXG4gICAgJ25nUGFyc2UnLFxuICAgICduZ01hdGVyaWFsJyxcbiAgICAnbmdNZXNzYWdlcydcbiAgXSlcbiAgICAuY29uZmlnKGZ1bmN0aW9uIChQYXJzZVByb3ZpZGVyKSB7XG4gICAgICAgIHZhciBNWV9QQVJTRV9BUFBfSUQgPSAndUR6TjdFN05ZSWJ3ZHpLTFV3TkJ0RHRHZnh5eHJyQm8zQzZ4R3JpMyc7XG4gICAgICAgIHZhciBNWV9QQVJTRV9KU19LRVkgPSAnMFZjV0VXQkxJd0VjRXhNMk56M1R6aVNHaktpTXNvVTdTTmpJNVJQQSc7XG4gICAgICAgIFBhcnNlUHJvdmlkZXIuaW5pdGlhbGl6ZShNWV9QQVJTRV9BUFBfSUQsIE1ZX1BBUlNFX0pTX0tFWSk7XG4gICAgICAgIFBhcnNlUHJvdmlkZXIuc2VydmVyVVJMID0gJ2h0dHBzOi8vcGFyc2VhcGkuYmFjazRhcHAuY29tLyc7XG5cbiAgICB9KVxuICAgIC5ydW4oZnVuY3Rpb24gKCR0cmFuc2l0aW9ucywgJHN0YXRlLCBBdXRoU2VydmljZSkge1xuICAgICAgICAkdHJhbnNpdGlvbnMub25TdGFydCh7XG4gICAgICAgICAgICB0bzogZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhKHN0YXRlLmRhdGEgJiYgc3RhdGUuZGF0YS5yZXF1aXJlZEF1dGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gQXV0aFNlcnZpY2VcbiAgICAgICAgICAgICAgICAucmVxdWlyZUF1dGhlbnRpY2F0aW9uKClcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHN0YXRlLnRhcmdldCgnYXV0aCcpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgJHRyYW5zaXRpb25zLm9uU3RhcnQoe1xuICAgICAgICAgICAgdG86ICdhdXRoJ1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHN0YXRlLmdvKCdhcHAnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG4iLCJhbmd1bGFyXG4gICAgLm1vZHVsZSgnY29tcG9uZW50cy5tZW1vcycsIFtcbiAgICAndWkucm91dGVyJ1xuICBdKTtcbiIsInZhciByb290ID0ge1xuICAgIHRlbXBsYXRlVXJsOiAnLi9yb290Lmh0bWwnXG59O1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgncm9vdCcpXG4gICAgLmNvbXBvbmVudCgncm9vdCcsIHJvb3QpO1xuIiwidmFyIGFwcCA9IHtcbiAgICB0ZW1wbGF0ZVVybDogJy4vYXBwLmh0bWwnLFxuICAgIGNvbnRyb2xsZXI6ICdBcHBDb250cm9sbGVyJ1xufTtcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ2NvbW1vbicpXG4gICAgLmNvbXBvbmVudCgnYXBwJywgYXBwKVxuICAgIC5jb25maWcoZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcCcsIHtcbiAgICAgICAgICAgICAgICByZWRpcmVjdFRvOiAnbWVtb3MnLFxuICAgICAgICAgICAgICAgIHVybDogJy8nLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWRBdXRoOiB0cnVlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6ICdhcHAnXG4gICAgICAgICAgICB9KVxuICAgIH0pO1xuIiwiZnVuY3Rpb24gQXBwQ29udHJvbGxlcihBdXRoU2VydmljZSwgJHN0YXRlKSB7XG4gICAgdmFyIGN0cmwgPSB0aGlzO1xuICAgIGN0cmwudXNlciA9IEF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICBjdHJsLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQXV0aFNlcnZpY2UubG9nb3V0KClcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2F1dGgubG9naW4nKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG59XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdjb21tb24nKVxuICAgIC5jb250cm9sbGVyKCdBcHBDb250cm9sbGVyJywgQXBwQ29udHJvbGxlcik7XG4iLCJmdW5jdGlvbiBpbml0KCRyb290U2NvcGUsICR1aVJvdXRlciwgJG1kU2lkZW5hdikge1xuICAgIHZhciBWaXN1YWxpemVyID0gd2luZG93Wyd1aS1yb3V0ZXItdmlzdWFsaXplciddLlZpc3VhbGl6ZXI7XG4gICAgdmFyIHBsdWdpbkluc3RhbmNlID0gJHVpUm91dGVyLnBsdWdpbihWaXN1YWxpemVyKTtcblxuICAgICRyb290U2NvcGUudG9nZ2xlTWVudSA9IHRvZ2dsZU1lbnU7XG5cbiAgICBmdW5jdGlvbiB0b2dnbGVNZW51KG5hdklkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0b2dnbGUgc2lkZW5hdjogJyArIG5hdklkKTtcbiAgICAgICAgJG1kU2lkZW5hdihuYXZJZClcbiAgICAgICAgICAgIC50b2dnbGUoKTtcbiAgICB9XG59XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdjb21tb24nKVxuICAgIC5ydW4oaW5pdClcbiIsInZhciBhdXRoID0ge1xuICAgIHRlbXBsYXRlVXJsOiAnLi9hdXRoLmh0bWwnLFxuICAgIGNvbnRyb2xsZXI6ICdBdXRoQ29udHJvbGxlcidcbn07XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzLmF1dGgnKVxuICAgIC5jb21wb25lbnQoJ2F1dGgnLCBhdXRoKVxuICAgIC5jb25maWcoZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC8vIC5zdGF0ZSgnYXV0aCcsIHtcbiAgICAgICAgICAgIC8vICAgICByZWRpcmVjdFRvOiAnYXV0aCcsXG4gICAgICAgICAgICAvLyAgICAgdXJsOiAnL2F1dGgnLFxuICAgICAgICAgICAgLy8gICAgIHRlbXBsYXRlVXJsOiAnLi9hdXRoLmh0bWwnXG4gICAgICAgICAgICAvLyB9KVxuICAgICAgICAgICAgLnN0YXRlKCdhdXRoJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9hdXRoJyxcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6ICdhdXRoJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvYXV0aCcpO1xuICAgIH0pO1xuIiwiLyoqXG4gKiBAbmdkb2Mgc2VydmljZVxuICogQG5hbWUgY29tcG9uZW50cy5hdXRoOkF1dGhTZXJ2aWNlXG4gKlxuICogQGRlc2NyaXB0aW9uIEhhbmRsZXMgYXV0aGVudGljYXRpb24gZm9yIGFwcFxuICovXG5cbmZ1bmN0aW9uIEF1dGhTZXJ2aWNlKFBhcnNlKSB7XG4gICAgdmFyIGF1dGggPSBuZXcgUGFyc2UuVXNlcigpOyAvLyBjcmVhdGVzIGEgbmV3IHVzZXIgaW4gUGFyc2VcbiAgICB2YXIgY3VycmVudFVzZXIgPSBudWxsOyAvL2hvbGRzIGluZm8gYWJvdXQgY3VycmVudCB1c2VyXG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgQXV0aFNlcnZpY2Ujc3RvcmVBdXRoRGF0YVxuICAgICAqIEBtZXRob2RPZiBjb21wb25lbnRzLmF1dGg6QXV0aFNlcnZpY2VcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gb2JqIFBhcnNlIHVzZXIgb2JqZWN0XG4gICAgICogQHJldHVybnMge29iamVjdH0gcmV0dXJucyBjdXJyZW50VXNlciBvYmplY3RcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIHN0b3JlQXV0aERhdGEocmVzcG9uc2UpIHtcbiAgICAgICAgY3VycmVudFVzZXIgPSByZXNwb25zZTtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRVc2VyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSBBdXRoU2VydmljZSNjbGVhckF1dGhEYXRhXG4gICAgICogQG1ldGhvZE9mIGNvbXBvbmVudHMuYXV0aDpBdXRoU2VydmljZVxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9IHJldHVybnMgYSBibGFuayB1c2VyIG9iamVjdFxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gY2xlYXJBdXRoRGF0YSgpIHtcbiAgICAgICAgY3VycmVudFVzZXIgPSBQYXJzZS5Vc2VyLmN1cnJlbnQoKTsgLy8gdGhpcyB3aWxsIG5vdyBiZSBudWxsXG4gICAgICAgIHJldHVybiBjdXJyZW50VXNlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgQXV0aFNlcnZpY2UjbG9naW5cbiAgICAgKiBAbWV0aG9kT2YgY29tcG9uZW50cy5hdXRoOkF1dGhTZXJ2aWNlXG4gICAgICogQHBhcmFtIHtvYmplY3R9IG9iaiB1c2VyIGRhdGEgZnJvbSBhdXRoLWZvcm1cbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSByZXR1cm5zIHRoZSBjdXJyZW50IHVzZXIgb2JqZWN0XG4gICAgICovXG5cbiAgICB0aGlzLmxvZ2luID0gZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgcmV0dXJuIFBhcnNlLlVzZXJcbiAgICAgICAgICAgIC5sb2dJbih1c2VyLmVtYWlsLCB1c2VyLnBhc3N3b3JkLCB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGF1dGgpIHt9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoYXV0aCwgZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihzdG9yZUF1dGhEYXRhKVxuICAgICAgICAgICAgLnRoZW4oKGN1cnJlbnRVc2VyKSA9PiB7XG4gICAgICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnY3VycmVudFVzZXInLCBjdXJyZW50VXNlcilcbiAgICAgICAgICAgIH0pO1xuXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSBBdXRoU2VydmljZSNyZWdpc3RlclxuICAgICAqIEBtZXRob2RPZiBjb21wb25lbnRzLmF1dGg6QXV0aFNlcnZpY2VcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gb2JqIHVzZXIgZGF0YSBmcm9tIGF1dGgtZm9ybVxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9IHJldHVybnMgdGhlIGN1cnJlbnQgdXNlciBvYmplY3RcbiAgICAgKi9cblxuICAgIHRoaXMucmVnaXN0ZXIgPSBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwiVXNlcjogXCIsIHVzZXIpO1xuICAgICAgICBhdXRoLnNldChcInVzZXJuYW1lXCIsIHVzZXIuZW1haWwpO1xuICAgICAgICBhdXRoLnNldChcInBhc3N3b3JkXCIsIHVzZXIucGFzc3dvcmQpO1xuICAgICAgICBhdXRoLnNldChcImVtYWlsXCIsIHVzZXIuZW1haWwpO1xuICAgICAgICByZXR1cm4gYXV0aFxuICAgICAgICAgICAgLnNpZ25VcChudWxsLCB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGF1dGgpIHt9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoYXV0aCwgZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJFcnJvcjogXCIgKyBlcnJvci5jb2RlICsgXCIgXCIgKyBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oc3RvcmVBdXRoRGF0YSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSBBdXRoU2VydmljZSNsb2dvdXRcbiAgICAgKiBAbWV0aG9kT2YgY29tcG9uZW50cy5hdXRoOkF1dGhTZXJ2aWNlXG4gICAgICogQHJldHVybnMge29iamVjdH0gcmV0dXJucyBhbiBlbXB0eSB1c2VyIG9iamVjdFxuICAgICAqL1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBQYXJzZS5Vc2VyLmxvZ091dCgpXG4gICAgICAgICAgICAudGhlbihjbGVhckF1dGhEYXRhKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAqIEBuYW1lIEF1dGhTZXJ2aWNlI3JlcXVpcmVBdXRoZW50aWNhdGlvblxuICAgICAqIEBtZXRob2RPZiBjb21wb25lbnRzLmF1dGg6QXV0aFNlcnZpY2VcbiAgICAgKiBAcmV0dXJucyB7cHJvbWlzZX0gcmV0dXJucyByZXNvbHZlIG9yIHJlamVjdCBiYXNlZCBvbiB1c2VyIGF1dGhlbnRpY2F0aW9uXG4gICAgICovXG5cbiAgICB0aGlzLnJlcXVpcmVBdXRoZW50aWNhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGlmICghIVBhcnNlLlVzZXIuY3VycmVudCgpICYmIFBhcnNlLlVzZXIuY3VycmVudCgpXG4gICAgICAgICAgICAgICAgLmF1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSBBdXRoU2VydmljZSNpc0F1dGhlbnRpY2F0ZWRcbiAgICAgKiBAbWV0aG9kT2YgY29tcG9uZW50cy5hdXRoOkF1dGhTZXJ2aWNlXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHJldHVybnMgd2hldGhlciB1c2VyIGlzIGF1dGhlbnRpY2F0ZWQgYmFzZWQgb24gc2Vzc2lvblN0b3JhZ2VcbiAgICAgKi9cblxuICAgIHRoaXMuaXNBdXRoZW50aWNhdGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyByZXR1cm4gISEoUGFyc2UuVXNlci5jdXJyZW50KCkgJiYgUGFyc2UuVXNlci5jdXJyZW50KClcbiAgICAgICAgLy8gICAgIC5hdXRoZW50aWNhdGVkKCkpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgQXV0aFNlcnZpY2UjZ2V0VXNlclxuICAgICAqIEBtZXRob2RPZiBjb21wb25lbnRzLmF1dGg6QXV0aFNlcnZpY2VcbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSByZXR1cm5zIGN1cnJlbnRVc2VyIHNlc3Npb25TdG9yYWdlIG9iamVjdFxuICAgICAqL1xuXG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoYXV0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGF1dGg7XG4gICAgICAgIH1cbiAgICB9O1xufTtcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ2NvbXBvbmVudHMuYXV0aCcpXG4gICAgLnNlcnZpY2UoJ0F1dGhTZXJ2aWNlJywgQXV0aFNlcnZpY2UpO1xuIiwidmFyIG1lbW9zID0ge1xuICAgIHRlbXBsYXRlVXJsOiAnLi9tZW1vcy5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnTWVtb3NDb250cm9sbGVyJyxcbiAgICBiaW5kaW5nczoge31cbn1cblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ2NvbXBvbmVudHMubWVtb3MnKVxuICAgIC5jb21wb25lbnQoJ21lbW9zJywgbWVtb3MpXG4gICAgLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ21lbW9zJywge1xuICAgICAgICAgICAgcGFyZW50OiAnYXBwJyxcbiAgICAgICAgICAgIHVybDogJ21lbW9zJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ21lbW9zJ1xuICAgICAgICB9KVxuICAgIH0pO1xuIiwiZnVuY3Rpb24gTWVtb3NDb250cm9sbGVyKCRzdGF0ZSkge1xuXG4gICAgdmFyIGN0cmwgPSB0aGlzO1xuICAgIGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIH1cblxufVxuXG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzLm1lbW9zJylcbiAgICAuY29udHJvbGxlcignTWVtb3NDb250cm9sbGVyJywgTWVtb3NDb250cm9sbGVyKTtcbiIsIi8qKlxuICogQG5nZG9jIGNvbXBvbmVudFxuICogQG5hbWUgY29tcG9uZW50LmF1dGg6YXV0aEZvcm1cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoaXMgaXMgdGhlIHN0YXRlbGVzcyBjb21wb25lbnQgZm9yIGF1dGggZm9ybVxuICpcbiAqIEBleGFtcGxlXG4gKiBsb2dpbi5odG1cbiA8cHJlPlxuIDxhdXRoLWZvcm0gdXNlcj1cIiRjdHJsLnVzZXJcIiBidXR0b249XCJMb2dpblwiIG9uLXN1Ym1pdD1cIiRjdHJsLmxvZ2luVXNlcigkZXZlbnQpO1wiIG9uLXJlc2V0PVwiJGN0cmwuZ29Ub1Jlc2V0KCk7XCI+XG4gPC9hdXRoLWZvcm0+XG4gIDwvcHJlPlxuICpcbiAqL1xuXG52YXIgYXV0aEZvcm0gPSB7XG4gICAgYmluZGluZ3M6IHtcbiAgICAgICAgdXNlcjogJzwnLFxuICAgICAgICBidXR0b246ICdAJyxcbiAgICAgICAgbWVzc2FnZTogJ0AnLFxuICAgICAgICBvblN1Ym1pdDogJyYnLFxuICAgICAgICBvblJlc2V0OiAnJidcbiAgICB9LFxuICAgIHRlbXBsYXRlVXJsOiAnLi9hdXRoLWZvcm0uaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ0F1dGhGb3JtQ29udHJvbGxlcidcbn07XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzLmF1dGgnKVxuICAgIC5jb21wb25lbnQoJ2F1dGhGb3JtJywgYXV0aEZvcm0pO1xuIiwiZnVuY3Rpb24gQXV0aEZvcm1Db250cm9sbGVyKCRzdGF0ZSkge1xuICB2YXIgY3RybCA9IHRoaXM7XG5cbiAgY3RybC4kb25DaGFuZ2VzID0gZnVuY3Rpb24gKGNoYW5nZXMpIHtcbiAgICBpZiAoY2hhbmdlcy51c2VyKSB7XG4gICAgICBjdHJsLnVzZXIgPSBhbmd1bGFyLmNvcHkoY3RybC51c2VyKTtcbiAgICB9XG4gIH07XG5cbiAgY3RybC5zdWJtaXRGb3JtID0gZnVuY3Rpb24gKCkge1xuICAgIC8vY29uc29sZS5sb2coXCJzdWJtaXQgY2FsbGVkXCIpO1xuICAgIGN0cmwub25TdWJtaXQoe1xuICAgICAgJGV2ZW50OiB7XG4gICAgICAgIHVzZXI6IGN0cmwudXNlclxuICAgICAgfVxuICAgIH0pO1xuICB9O1xufVxuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnY29tcG9uZW50cy5hdXRoJylcbiAgICAuY29udHJvbGxlcignQXV0aEZvcm1Db250cm9sbGVyJywgQXV0aEZvcm1Db250cm9sbGVyKTtcbiIsIi8qKlxuICogQG5nZG9jIGNvbXBvbmVudFxuICogQG5hbWUgY29tcG9uZW50LmF1dGg6bG9naW5cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoaXMgY29tcG9uZW50IHN0b3JlcyBpbmZvIGZyb20gYXV0aC1mb3JtIGFuZCBoYW5kbGVzIGxvZ2luIHVzaW5nIEF1dGhTZXJ2aWNlXG4gKlxuICovXG5cbnZhciBsb2dpbiA9IHtcbiAgICB0ZW1wbGF0ZVVybDogJy4vbG9naW4uaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ0xvZ2luQ29udHJvbGxlcidcbn07XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzLmF1dGgnKVxuICAgIC5jb21wb25lbnQoJ2xvZ2luJywgbG9naW4pXG4gICAgLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLy8gLnN0YXRlKCdhdXRoJywge1xuICAgICAgICAgICAgLy8gICAgIHJlZGlyZWN0VG86ICdhdXRoLmxvZ2luJyxcbiAgICAgICAgICAgIC8vICAgICB1cmw6ICcvYXV0aCcsXG4gICAgICAgICAgICAvLyAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXc+PC9kaXY+J1xuICAgICAgICAgICAgLy8gfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnYXV0aC5sb2dpbicsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ2xvZ2luJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIC8vICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9hdXRoL2xvZ2luJyk7XG4gICAgfSk7XG4iLCJmdW5jdGlvbiBMb2dpbkNvbnRyb2xsZXIoQXV0aFNlcnZpY2UsICRzdGF0ZSkge1xuICAgIHZhciBjdHJsID0gdGhpcztcblxuICAgIC8vaW5pdGlhbGl6ZSB1c2VyIGRhdGFcbiAgICBjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGN0cmwudXNlciA9IHtcbiAgICAgICAgICAgIGVtYWlsOiAnJyxcbiAgICAgICAgICAgIHBhc3N3b3JkOiAnJ1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgLy9naXZlIHVzZXIgYWNjZXNzIHRvIGFwcFxuICBjdHJsLmxvZ2luVXNlciA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgIHJldHVybiBBdXRoU2VydmljZVxuICAgICAgLmxvZ2luKGV2ZW50LnVzZXIpXG4gICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzdGF0ZS5nbygnYXBwJyk7XG4gICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgIGFsZXJ0KHJlYXNvbik7XG4gICAgICB9KTtcbiAgfTtcblxuICBjdHJsLmdvVG9SZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAkc3RhdGUuZ28oJ2F1dGgucmVzZXQnKTtcbiAgfVxuXG59XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzLmF1dGgnKVxuICAgIC5jb250cm9sbGVyKCdMb2dpbkNvbnRyb2xsZXInLCBMb2dpbkNvbnRyb2xsZXIpO1xuIiwiLyoqXG4gKiBAbmdkb2MgY29tcG9uZW50XG4gKiBAbmFtZSBjb21wb25lbnQuYXV0aDpyZWdpc3RlclxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhpcyBjb21wb25lbnQgc3RvcmVzIGluZm8gZnJvbSBhdXRoLWZvcm0gYW5kIGhhbmRsZXMgcmVnaXN0ZXJpbmcgdXNpbmcgQXV0aFNlcnZpY2VcbiAqXG4gKi9cblxudmFyIHJlZ2lzdGVyID0ge1xuICAgIHRlbXBsYXRlVXJsOiAnLi9yZWdpc3Rlci5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnUmVnaXN0ZXJDb250cm9sbGVyJ1xufTtcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ2NvbXBvbmVudHMuYXV0aCcpXG4gICAgLmNvbXBvbmVudCgncmVnaXN0ZXInLCByZWdpc3RlcilcbiAgICAuY29uZmlnKGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnYXV0aC5yZWdpc3RlcicsIHtcbiAgICAgICAgICAgIHVybDogJy9yZWdpc3RlcicsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdyZWdpc3RlcidcbiAgICAgICAgfSk7XG4gICAgfSk7XG4iLCJmdW5jdGlvbiBSZWdpc3RlckNvbnRyb2xsZXIoQXV0aFNlcnZpY2UsICRzdGF0ZSkge1xuICAgIHZhciBjdHJsID0gdGhpcztcblxuICAgIC8vaW5pdGlhbGl6ZSB1c2VyIGRhdGFcbiAgICBjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGN0cmwuZXJyb3IgPSBudWxsO1xuICAgICAgICBjdHJsLnVzZXIgPSB7XG4gICAgICAgICAgICBlbWFpbDogJycsXG4gICAgICAgICAgICBwYXNzd29yZDogJydcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgLy9jcmVhdGVzIGEgbmV3IHVzZXIgYW5kIGFsbG93cyBhY2Nlc3MgaW50byB0aGUgYXBwXG4gICAgY3RybC5jcmVhdGVVc2VyID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJ1c2VyOlwiLCBldmVudCk7XG4gICAgICAgIHJldHVybiBBdXRoU2VydmljZVxuICAgICAgICAgICAgLnJlZ2lzdGVyKGV2ZW50LnVzZXIpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdhcHAnKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgICAgICAgICAgICBjdHJsLmVycm9yID0gcmVhc29uLm1lc3NhZ2U7XG4gICAgICAgICAgICB9KTtcbiAgICB9O1xuXG59XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzLmF1dGgnKVxuICAgIC5jb250cm9sbGVyKCdSZWdpc3RlckNvbnRyb2xsZXInLCBSZWdpc3RlckNvbnRyb2xsZXIpO1xuIiwiLyoqXG4gKiBAbmdkb2MgY29tcG9uZW50XG4gKiBAbmFtZSBjb21wb25lbnQuYXV0aDpyZXNldFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhpcyBjb21wb25lbnQgaGFuZGxlcyBwYXNzd29yZCByZXNldCBhbmQgaXMgdG9nZ2xlZCBpbiBsb2dpbiBjb21wb25lbnQgXG4gKlxuICovXG5cbnZhciByZXNldCA9IHtcbiAgICB0ZW1wbGF0ZVVybDogJy4vcmVzZXQuaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ1Jlc2V0Q29udHJvbGxlcidcbn07XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzLmF1dGgnKVxuICAgIC5jb21wb25lbnQoJ3Jlc2V0JywgcmVzZXQpXG4gICAgLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2F1dGgucmVzZXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvcmVzZXQnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAncmVzZXQnXG4gICAgICAgIH0pO1xuICAgIH0pO1xuIiwiZnVuY3Rpb24gUmVzZXRDb250cm9sbGVyKCkge1xuXG4gICAgdmFyIGN0cmwgPSB0aGlzO1xuXG4gICAgY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgY29uc29sZS5sb2coXCJSRVNFVCBDT05UUk9MTEVSIEZJUkVEXCIpXG4gICAgICAgIC8vIGluaXRpYWxpemUgdmFyaWFibGVzXG4gICAgICAgIGN0cmwudXNlciA9IHt9O1xuICAgICAgICAvLyBpbml0aWFsaXplIGZ1bmN0aW9uc1xuICAgICAgICBjdHJsLnJlc2V0ID0gcmVzZXQ7XG4gICAgfVxuXG4gICAgLy8gcGFzc3dvcmQgcmVzZXRcbiAgICBmdW5jdGlvbiByZXNldChlbWFpbCkge1xuICAgICAgICBpZiAoZW1haWwpIHtcbiAgICAgICAgICAgIFBhcnNlXG4gICAgICAgICAgICAgICAgLlVzZXJcbiAgICAgICAgICAgICAgICAucmVxdWVzdFBhc3N3b3JkUmVzZXQoZW1haWwpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBhbGVydCgnQSBwYXNzd29yZCByZXNldCBlbWFpbCBoYXMgYmVlbiBzZW50IHRvICcgKyBlbWFpbCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICBhbGVydChlcnIuY29kZSArIFwiIFwiICsgZXJyLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG59XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzLmF1dGgnKVxuICAgIC5jb250cm9sbGVyKCdSZXNldENvbnRyb2xsZXInLCBSZXNldENvbnRyb2xsZXIpO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3RlbXBsYXRlcycsIFtdKS5ydW4oWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uKCR0ZW1wbGF0ZUNhY2hlKSB7JHRlbXBsYXRlQ2FjaGUucHV0KCcuL3Jvb3QuaHRtbCcsJzxkaXYgY2xhc3M9XCJyb290XCI+XFxuICAgIDxkaXYgdWktdmlldz48L2Rpdj5cXG48L2Rpdj5cXG4nKTtcbiR0ZW1wbGF0ZUNhY2hlLnB1dCgnLi9hcHAuaHRtbCcsJzxkaXYgY2xhc3M9XCJyb290XCI+XFxuICAgIDwhLS0gPGFwcC1uYXYgdXNlcj1cIiRjdHJsLnVzZXJcIiBvbi1sb2dvdXQ9XCIkY3RybC5sb2dvdXQoKTtcIj48L2FwcC1uYXY+IC0tPlxcbiAgICA8IS0tIDxtZC1zaWRlbmF2IGZsZXgtb3JkZXI9XCIyXCIgbWQtY29tcG9uZW50LWlkPVwic2lkZVwiIG1kLXdoaXRlZnJhbWU9XCIzXCIgbWQtZGlzYWJsZS1iYWNrZHJvcCBjbGFzcz1cIm1kLXNpZGVuYXYtcmlnaHQgbWQtbm8tcGFnaW5hdGlvbiBhcHBfX3NpZGVuYXYtLWhlaWdodCBhcHBfX3NpZGVuYXYtLXdpZHRoIGFwcF9fc2lkZW5hdi0tcG9zaXRpb24gYXBwX19zaWRlbmF2LS1vdmVyZmxvdy14XCI+XFxuICAgICAgICA8ZGl2IHVpLXZpZXc9XCJzaWRlXCI+PC9kaXY+XFxuICAgIDwvbWQtc2lkZW5hdj4gLS0+XFxuICAgIDxkaXY+XFxuICAgICAgICA8ZGl2IHVpLXZpZXc+PC9kaXY+XFxuICAgIDwvZGl2PlxcbjwvZGl2PlxcbicpO1xuJHRlbXBsYXRlQ2FjaGUucHV0KCcuL2F1dGguaHRtbCcsJzxkaXY+XFxuICBIZWxsbyBXb3JsZFxcbjwvZGl2PlxcbicpO1xuJHRlbXBsYXRlQ2FjaGUucHV0KCcuL21lbW9zLmh0bWwnLCc8ZGl2PlxcbiAgVGhpcyBpcyB0aGUgYXBwLlxcbjwvZGl2PlxcbicpO1xuJHRlbXBsYXRlQ2FjaGUucHV0KCcuL2F1dGgtZm9ybS5odG1sJywnPGZvcm0gd2lkdGg9XCIxMDAlXCIgbmFtZT1cImF1dGhGb3JtXCIgbm92YWxpZGF0ZSBuZy1zdWJtaXQ9XCIkY3RybC5zdWJtaXRGb3JtKCk7XCI+XFxuICA8ZGl2IHdpZHRoPVwiMTAwJVwiIGxheW91dD1cImNvbHVtblwiIGxheW91dC1hbGlnbj1cImNlbnRlciBjZW50ZXJcIj5cXG4gICAgPGRpdj5cXG4gICAgICA8aW1nIHNyYz1cImltZy9tdWdodWJfbG9nby5wbmdcIiB3aWR0aD1cIjIxMHB4XCIgLz5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgc3R5bGU9XCJtaW4td2lkdGg6MjUlXCI+XFxuXFxuICAgICAgPG1kLWxpc3Q+XFxuICAgICAgICA8bWQtbGlzdC1pdGVtIGNsYXNzPVwiYXV0aF9fbGlzdEl0ZW0tLW1hcmdpblRvcFwiPlxcbiAgICAgICAgICA8bWQtaW5wdXQtY29udGFpbmVyIGNsYXNzPVwibWQtYmxvY2tcIiBsYXlvdXQtZmlsbD5cXG4gICAgICAgICAgICA8bGFiZWwgc3R5bGU9XCJjb2xvcjogICNlYWVhZWE7IGZvbnQtc2l6ZTogMTNweDsgZm9udC1mYW1pbHk6IFxcJ01vbnRzZXJyYXRcXCcsIHNhbnMtc2VyaWY7IHBhZGRpbmc6IDVweCAwcHggMHB4IDIwcHhcIj48aSBzdHlsZT1cInZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IGNvbG9yOiNlYWVhZWE7IG1hcmdpbjowcHggNHB4IDFweCA0cHhcIiBjbGFzcz1cIm1hdGVyaWFsLWljb25zIG1kLTE4XCI+cGVyc29uPC9pPlVTRVJOQU1FPC9sYWJlbD5cXG4gICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJhdXRoX19pbnB1dC0tc3R5bGUgYXV0aF9faW5wdXQtLWhlaWdodFwiIHR5cGU9XCJlbWFpbFwiIG5hbWU9XCJlbWFpbFwiIG5nLW1vZGVsPVwiJGN0cmwudXNlci5lbWFpbFwiIGF1dG9jb21wbGV0ZT1cIm9mZlwiIC8+XFxuICAgICAgICAgIDwvbWQtaW5wdXQtY29udGFpbmVyPlxcbiAgICAgICAgPC9tZC1saXN0LWl0ZW0+XFxuICAgICAgICA8bWQtbGlzdC1pdGVtIGxheW91dC1hbGlnbj1cImNlbnRlciBjZW50ZXJcIiBsYXlvdXQ9XCJyb3dcIiBjbGFzcz1cImF1dGhfX2xpc3RJdGVtLS1tYXJnaW5Ub3BcIj5cXG4gICAgICAgICAgPG1kLWlucHV0LWNvbnRhaW5lciBtZC1uby1mbG9hdCBjbGFzcz1cIm1kLWJsb2NrIGF1dGhfX2lucHV0XCIgc3R5bGU9XCJwb3NpdGlvbjogcmVsYXRpdmU7IHdpZHRoOjEwMCVcIj5cXG4gICAgICAgICAgICA8bGFiZWwgc3R5bGU9XCJjb2xvcjogICNlYWVhZWE7IGZvbnQtc2l6ZTogMTNweDsgZm9udC1mYW1pbHk6IFxcJ01vbnRzZXJyYXRcXCcsIHNhbnMtc2VyaWY7IHBhZGRpbmc6IDVweCAwcHggMHB4IDIwcHhcIj48aSBzdHlsZT1cInZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IGNvbG9yOiNlYWVhZWE7IG1hcmdpbjowcHggNHB4XCIgY2xhc3M9XCJtYXRlcmlhbC1pY29ucyBtZC0xOFwiPmxvY2s8L2k+IFBBU1NXT1JEPC9sYWJlbD5cXG4gICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJhdXRoX19pbnB1dC0tc3R5bGUgYXV0aF9faW5wdXQtLWhlaWdodFwiIHR5cGU9XCJwYXNzd29yZFwiIG5hbWU9XCJwYXNzd29yZFwiIG5nLW1vZGVsPVwiJGN0cmwudXNlci5wYXNzd29yZFwiIGF1dG9jb21wbGV0ZT1cIm9mZlwiIC8+XFxuICAgICAgICAgIDwvbWQtaW5wdXQtY29udGFpbmVyPlxcbiAgICAgICAgICA8cCBuZy1pZj1cIiRjdHJsLmJ1dHRvbiA9PT0gXFwnTG9naW5cXCdcIiBuZy1jbGljaz1cIiRjdHJsLm9uUmVzZXQoJGV2ZW50KVwiIGNsYXNzPVwiYXV0aF9fZm9yZ290XCI+PzwvcD5cXG4gICAgICAgIDwvbWQtbGlzdC1pdGVtPlxcbiAgICAgIDwvbWQtbGlzdD5cXG5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgc3R5bGU9XCJtYXJnaW4tdG9wOiAtMThweDtcIj5cXG4gICAgICA8bWQtYnV0dG9uIHR5cGU9XCJzdWJtaXRcIiBuZy1kaXNhYmxlZD1cImF1dGhGb3JtLiRpbnZhbGlkXCIgY2xhc3M9XCJtZC1yYWlzZWQgYXV0aF9fYnV0dG9uIGF1dGhfX2lucHV0LS1oZWlnaHRcIj5cXG4gICAgICAgIDxoMSBjbGFzcz1cImF1dGhfX2J1dHRvblRleHRcIj57eyAkY3RybC5idXR0b24gfX08L2gxPlxcbiAgICAgIDwvbWQtYnV0dG9uPlxcbiAgICA8L2Rpdj5cXG4gIDwvZGl2PlxcbjwvZm9ybT5cXG4nKTtcbiR0ZW1wbGF0ZUNhY2hlLnB1dCgnLi9sb2dpbi5odG1sJywnPGRpdiBjbGFzcz1cImF1dGhcIiBsYXlvdXQ9XCJjb2x1bW5cIiBsYXlvdXQtYWxpZ249XCJjZW50ZXJcIj5cXG4gICAgPGRpdj5cXG4gICAgICAgIDxhdXRoLWZvcm0gdXNlcj1cIiRjdHJsLnVzZXJcIiBidXR0b249XCJMb2dpblwiIG9uLXN1Ym1pdD1cIiRjdHJsLmxvZ2luVXNlcigkZXZlbnQpO1wiIG9uLXJlc2V0PVwiJGN0cmwuZ29Ub1Jlc2V0KCk7XCI+XFxuICAgICAgICA8L2F1dGgtZm9ybT5cXG4gICAgPC9kaXY+XFxuICAgIDxjZW50ZXI+XFxuICAgICAgICA8ZGl2PlxcbiAgICAgICAgICAgIDxhIHVpLXNyZWY9XCJhdXRoLnJlZ2lzdGVyXCIgY2xhc3M9XCJhdXRoX190cmFuc1wiPlxcbiAgICAgIERvblxcJ3QgaGF2ZSBhbiBhY2NvdW50PyBDcmVhdGUgb25lIGhlcmUuXFxuICAgIDwvYT5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2NlbnRlcj5cXG48L2Rpdj5cXG4nKTtcbiR0ZW1wbGF0ZUNhY2hlLnB1dCgnLi9yZWdpc3Rlci5odG1sJywnPGRpdiBjbGFzcz1cImF1dGhcIiBsYXlvdXQ9XCJjb2x1bW5cIiBsYXlvdXQtYWxpZ249XCJjZW50ZXJcIj5cXG4gICAgPGRpdj5cXG4gICAgICAgIDxhdXRoLWZvcm0gdXNlcj1cIiRjdHJsLnVzZXJcIiBtZXNzYWdlPVwie3sgJGN0cmwuZXJyb3IgfX1cIiBidXR0b249XCJDcmVhdGUgdXNlclwiIG9uLXN1Ym1pdD1cIiRjdHJsLmNyZWF0ZVVzZXIoJGV2ZW50KTtcIj5cXG4gICAgICAgIDwvYXV0aC1mb3JtPlxcbiAgICA8L2Rpdj5cXG4gICAgPGNlbnRlcj5cXG4gICAgICAgIDxkaXY+XFxuICAgICAgICAgICAgPGEgdWktc3JlZj1cImF1dGgubG9naW5cIiBjbGFzcz1cImF1dGhfX3RyYW5zXCI+QWxyZWFkeSBoYXZlIGFuIGFjY291bnQ/IExvZ2luIGhlcmUuPC9hPlxcbiAgICAgICAgPC9kaXY+XFxuICAgIDwvY2VudGVyPlxcbjwvZGl2PlxcbicpO1xuJHRlbXBsYXRlQ2FjaGUucHV0KCcuL3Jlc2V0Lmh0bWwnLCc8ZGl2IGNsYXNzPVwiYXV0aFwiIGxheW91dD1cImNvbHVtblwiIGxheW91dC1hbGlnbj1cImNlbnRlclwiPlxcbiAgICA8Zm9ybSB3aWR0aD1cIjEwMCVcIiBuYW1lPVwiYXV0aEZvcm1cIiBub3ZhbGlkYXRlIG5nLXN1Ym1pdD1cIiRjdHJsLnJlc2V0KCRjdHJsLnVzZXIuZW1haWwpXCI+XFxuICAgICAgICA8ZGl2IHdpZHRoPVwiMTAwJVwiIGxheW91dD1cImNvbHVtblwiIGxheW91dC1hbGlnbj1cImNlbnRlciBjZW50ZXJcIj5cXG4gICAgICAgICAgICA8ZGl2PlxcbiAgICAgICAgICAgICAgICA8aW1nIHNyYz1cImltZy8yMDAwcHgtR2VuZXJhbF9FbGVjdHJpY19sb2dvLnN2Zy5wbmdcIiB3aWR0aD1cIjUwcHhcIiAvPlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJtaW4td2lkdGg6MjUlXCI+XFxuICAgICAgICAgICAgICAgIDxtZC1saXN0PlxcbiAgICAgICAgICAgICAgICAgICAgPG1kLWxpc3QtaXRlbT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8bWQtaW5wdXQtY29udGFpbmVyIGNsYXNzPVwibWQtYmxvY2tcIiBsYXlvdXQtZmlsbD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkVtYWlsPC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJlbWFpbFwiIG5hbWU9XCJlbWFpbFwiIG5nLW1vZGVsPVwiJGN0cmwudXNlci5lbWFpbFwiIGF1dG9jb21wbGV0ZT1cIm9mZlwiIC8+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9tZC1pbnB1dC1jb250YWluZXI+XFxuICAgICAgICAgICAgICAgICAgICA8L21kLWxpc3QtaXRlbT5cXG4gICAgICAgICAgICAgICAgPC9tZC1saXN0PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDxkaXY+XFxuICAgICAgICAgICAgICAgIDxtZC1idXR0b24gdHlwZT1cInN1Ym1pdFwiIG5nLWRpc2FibGVkPVwiYXV0aEZvcm0uJGludmFsaWRcIiBjbGFzcz1cIm1kLXJhaXNlZCBhdXRoX19idXR0b25cIj5cXG4gICAgICAgICAgICAgICAgICAgIDxoMSBjbGFzcz1cImF1dGhfX2J1dHRvblRleHRcIj5SRVNFVDwvaDE+XFxuICAgICAgICAgICAgICAgIDwvbWQtYnV0dG9uPlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgIDwvZm9ybT5cXG4gICAgPGNlbnRlcj5cXG4gICAgICAgIDxkaXY+XFxuICAgICAgICAgICAgPGEgdWktc3JlZj1cImF1dGgubG9naW5cIiBjbGFzcz1cImF1dGhfX3RyYW5zXCI+T3IgbG9naW4gd2l0aCBhbiBleGlzdGluZyBhY2NvdW50LjwvYT5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2NlbnRlcj5cXG48L2Rpdj5cXG4nKTt9XSk7Il19
